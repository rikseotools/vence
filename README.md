# ğŸš€ Sistema iLoveTest - Plataforma Inteligente de Oposiciones

> **ğŸ§  DIFERENCIADOR CLAVE**: No somos "otra web de tests" - somos el primer **Asistente Personal de Aprendizaje Legal** que aprende de ti y te guÃ­a inteligentemente hacia la excelencia.

## ğŸ¯ **La RevoluciÃ³n: IA Personal + Tests Tradicionales**

### ğŸ§  **Sistema de Notificaciones Inteligentes + PWA** â­ *PIEDRA ANGULAR*
**Lo que nos hace Ãºnicos en el mercado:**

- **ğŸ“Š AnÃ¡lisis AutomÃ¡tico**: Tu comportamiento de estudio se convierte en insights personalizados
- **ğŸ¯ PredicciÃ³n de Problemas**: Detecta regresiones antes de que las notes
- **ğŸ’¡ MotivaciÃ³n Adaptativa**: Solo cuando realmente aporta valor (no spam)
- **ğŸš€ Acciones Directas**: Cada notificaciÃ³n lleva a una soluciÃ³n especÃ­fica
- **âš¡ Tiempo Real**: Aprende y se adapta constantemente a tu progreso
- **ğŸ“± PWA Tracking**: Sistema completo de tracking de instalaciones y uso PWA
- **ğŸ”” Push Notifications**: GestiÃ³n avanzada con anÃ¡lisis de engagement

### ğŸ“ˆ **Tipos de Inteligencia Implementada:**

#### ğŸš¨ **Alertas CrÃ­ticas** (Prioridad 90-100)
- **RegresiÃ³n de Nivel**: "Tu rendimiento en Art. 103 bajÃ³ 15% â†’ Test de Refuerzo (5 min)"
- **Racha Rota**: "5 dÃ­as sin estudiar â†’ Test de RecuperaciÃ³n (3 min)"  
- **ArtÃ­culos ProblemÃ¡ticos**: "LPAC Arts. 1,2,3 con <70% accuracy â†’ Test Intensivo"

#### ğŸ¯ **Recomendaciones Inteligentes** (Prioridad 70-89)
- **OptimizaciÃ³n de Rachas**: "3 dÃ­as seguidos â†’ Mantener Racha (5 min)"
- **Logros Detectados**: "10 tests esta semana â†’ PrÃ³ximo DesafÃ­o"

#### ğŸ’¡ **MotivaciÃ³n Adaptativa** (Solo cuando campana vacÃ­a)
- **Progreso Real**: "Llevas 4 dÃ­as seguidos estudiando (2h 30m total)"
- **Mejoras Detectadas**: "Tu precisiÃ³n en Tema 5 mejorÃ³ del 65% al 82%"
- **Velocidad**: "Respondes 3s mÃ¡s rÃ¡pido que hace una semana"
- **MaestrÃ­a**: "Has dominado 2 artÃ­culos nuevos: Tema 3 Art. 104 (89%)"
- **Patrones**: "Estudias mejor a las 19:00-20:00 (85% accuracy)"

> ğŸ“– **[Ver documentaciÃ³n completa del Sistema de Inteligencia](./NOTIFICATIONS_SYSTEM.md)**

---

## ğŸ“‹ **Sistema Base de Tests Avanzados**

Construido sobre la plataforma mÃ¡s completa del mercado:

- **Tests configurables** (25/50/100 preguntas)
- **GeneraciÃ³n personalizada** (falladas/acertadas/aleatorias/mixtas)
- **Preguntas reutilizables** por artÃ­culo para mÃºltiples oposiciones
- **Mapeo inteligente** tema â†’ leyes â†’ artÃ­culos especÃ­ficos
- **Tracking granular** de errores por tema/ley/artÃ­culo
- **Sistema de usuarios** con Google OAuth
- **Analytics de progreso** y recomendaciones personalizadas
- **ğŸ†• EXÃMENES OFICIALES EXACTOS** - RecreaciÃ³n de exÃ¡menes reales
- **ğŸ†• CONTEXTO HISTÃ“RICO** - ArtÃ­culos que "caen seguro" en exÃ¡menes
- **ğŸ†• PWA TRACKING COMPLETO** - Sistema de seguimiento de instalaciones y uso
- **ğŸ†• ANALYTICS PUSH REALES** - Datos reales de notificaciones y engagement
- **ğŸ‰ CONSTITUCIÃ“N ESPAÃ‘OLA COMPLETA** - 169 artÃ­culos mapeados (100%)
- **ğŸ†• CONTROL DE VERSIONES** - Sistema de actualizaciÃ³n legal automÃ¡tico
- **ğŸ†• ARQUITECTURA HÃBRIDA** - Consultas rÃ¡pidas + anÃ¡lisis profundo
- **âœ¨ MODO ADAPTATIVO** - Se ajusta automÃ¡ticamente al rendimiento del usuario

---

## ğŸ¯ Objetivos del Sistema

### âœ… Tests DinÃ¡micos y Personalizados
- ConfiguraciÃ³n flexible de nÃºmero de preguntas por test
- **GeneraciÃ³n inteligente:** falladas, acertadas, aleatorias, mixtas
- **Mapeo preciso:** cada tema sabe exactamente quÃ© leyes/artÃ­culos incluye
- **Tests por estructura legal:** TÃ­tulo Preliminar, CapÃ­tulo I, SecciÃ³n 1Âª, etc.
- Soporte para tests mixtos (mÃºltiples temas/leyes)

### âœ… Arquitectura de Preguntas Reutilizables â­ *IMPLEMENTADO*
- **Preguntas asociadas a artÃ­culos especÃ­ficos** (no a temas)
- **ReutilizaciÃ³n automÃ¡tica** para mÃºltiples oposiciones
- **Una pregunta del Art. 103 CE** sirve para Auxiliar Administrativo, Administrativo C1, GestiÃ³n Procesal, etc.
- **Zero duplicaciÃ³n** de contenido entre temas y oposiciones

### âœ… Sistema de ExÃ¡menes Oficiales â­ *REVOLUCIONARIO*
- **RecreaciÃ³n exacta** de exÃ¡menes oficiales reales
- **Preguntas idÃ©nticas** a las que aparecieron en convocatorias pasadas
- **Dos modalidades:**
  - **"Tema X - Solo preguntas oficiales"** - Preguntas que cayeron de ese tema
  - **"Examen Oficial 2023 Completo"** - RecreaciÃ³n exacta del examen real
- **Contexto histÃ³rico:** "Esta pregunta cayÃ³ en 2023, 2022, 2021"
- **ClasificaciÃ³n por frecuencia:** VERY_FREQUENT, FREQUENT, OCCASIONAL

### âœ… Inteligencia Contextual â­ *NUEVA GENERACIÃ“N*
- **Mensajes motivacionales:** "âš¡ Â¡MEMORIZA LITERALMENTE!" para artÃ­culos muy preguntados
- **DiferenciaciÃ³n por oposiciÃ³n:** Solo muestra contexto relevante para cada oposiciÃ³n especÃ­fica
- **Estrategia de estudio:** Los usuarios saben exactamente quÃ© priorizar
- **Arquitectura hÃ­brida:** `article_exam_stats` para consultas rÃ¡pidas + `articulos_examenes` para anÃ¡lisis histÃ³rico

### âœ… Control de Versiones Legal â­ *NUEVO*
- **Sistema de integridad:** Hashes SHA-256 para detectar cambios automÃ¡ticamente
- **VerificaciÃ³n automÃ¡tica:** Alertas cuando una ley necesita actualizaciÃ³n
- **Trazabilidad completa:** Historial de versiones de cada artÃ­culo
- **Fuentes oficiales:** Enlaces directos al BOE consolidado
- **Alertas inteligentes:** PriorizaciÃ³n por urgencia (URGENTE, ALTA, MEDIA, BAJA)

### âœ… Repaso Inteligente
- **"25 preguntas falladas del Tema 5"** - Solo las que el usuario falla
- **"15 falladas + 10 aleatorias"** - Combinaciones personalizadas  
- **"Solo preguntas nunca vistas"** - Contenido fresco
- **âœ¨ Modo Adaptativo AutomÃ¡tico:** 
  - Se activa automÃ¡ticamente cuando el rendimiento baja del 60%
  - Muestra indicador visual `âœ¨ AdaptÃ¡ndose a tu nivel` en tiempo real
  - Disponible en tests aleatorios y por tema
  - ConfiguraciÃ³n opcional con toggle activado por defecto

### âœ… Mapeo Tema â†” Contenido Legal
- **Tema 5 Auxiliar Administrativo** â†’ CE Art. 103-106 + LRJSP Cap. I
- **Tema 8 Administrativo C1** â†’ CE Art. 103-106 (reutiliza mismas preguntas)
- **Flexibilidad total:** artÃ­culos especÃ­ficos, tÃ­tulos completos, capÃ­tulos, etc.

### âœ… Tracking Inteligente
- Registro de errores por usuario, tema, ley y artÃ­culo
- Seguimiento temporal del progreso
- IdentificaciÃ³n automÃ¡tica de puntos dÃ©biles
- MÃ©tricas de mejora por Ã¡rea de conocimiento

### âœ… Sistema de Usuarios
- AutenticaciÃ³n con Google OAuth
- Progreso persistente en la nube
- Perfil personalizado de aprendizaje
- Acceso multiplataforma

---

## ğŸ—ï¸ Arquitectura de Base de Datos

### ğŸ“Š **Esquema Completo (25 tablas principales)**

```
ğŸ“š CONTENIDO LEGAL (4 tablas)
â”œâ”€â”€ laws - Normativa legal (CE, LPAC, etc.)
â”œâ”€â”€ articles - ArtÃ­culos especÃ­ficos de cada ley  
â”œâ”€â”€ topics - Temas de oposiciones estructurados
â””â”€â”€ topic_scope - Mapeo inteligente tema â†” artÃ­culos

â“ PREGUNTAS Y TESTS (4 tablas)
â”œâ”€â”€ questions - Preguntas reutilizables por artÃ­culo
â”œâ”€â”€ test_configurations - Configuraciones guardadas de tests
â”œâ”€â”€ test_questions - RelaciÃ³n tests â†” preguntas
â””â”€â”€ tests - Sesiones de tests completadas

ğŸ¯ EXÃMENES OFICIALES (6 tablas) â­ IMPLEMENTADO
â”œâ”€â”€ oposiciones - Tipos de oposiciones disponibles
â”œâ”€â”€ convocatorias - AÃ±os y detalles de exÃ¡menes
â”œâ”€â”€ articulos_examenes - Historial de artÃ­culos en exÃ¡menes
â”œâ”€â”€ preguntas_examenes_oficiales - Preguntas exactas de exÃ¡menes
â”œâ”€â”€ oposicion_topics - Mapeo oposiciÃ³n â†” temas
â””â”€â”€ oposicion_articles - Mapeo directo oposiciÃ³n â†” artÃ­culos

ğŸ†• NUEVA ARQUITECTURA HÃBRIDA (1 tabla) â­ REVOLUCIONARIO
â””â”€â”€ article_exam_stats - EstadÃ­sticas agregadas para consultas rÃ¡pidas

ğŸ†• CONTROL DE VERSIONES (4 tablas) â­ NUEVO
â”œâ”€â”€ law_versions - Historial de versiones de leyes
â”œâ”€â”€ article_versions - Historial de versiones de artÃ­culos
â”œâ”€â”€ version_checks - ProgramaciÃ³n de verificaciones
â””â”€â”€ law_update_status - Vista de estado actualizaciÃ³n

âœ¨ SISTEMA IA ADAPTATIVO (4 tablas) â­ REVOLUCIONARIO
â”œâ”€â”€ user_question_history - Historial personal por pregunta
â”œâ”€â”€ user_difficulty_metrics - MÃ©tricas agregadas de dificultad
â”œâ”€â”€ user_sessions - Sesiones detalladas de usuario
â””â”€â”€ user_learning_analytics - Analytics de aprendizaje

ğŸ‘¤ USUARIOS Y PROGRESO (4 tablas)
â”œâ”€â”€ user_profiles - Perfiles y preferencias
â”œâ”€â”€ user_progress - Progreso detallado por artÃ­culo
â”œâ”€â”€ user_recommendations - Recomendaciones personalizadas
â””â”€â”€ user_notifications - Sistema de notificaciones inteligentes

ğŸ“± PWA Y NOTIFICACIONES (4 tablas) â­ NUEVO
â”œâ”€â”€ pwa_events - Eventos de instalaciÃ³n y uso PWA
â”œâ”€â”€ pwa_sessions - Sesiones detalladas PWA vs Web
â”œâ”€â”€ notification_events - Eventos de notificaciones push
â””â”€â”€ email_events - Analytics de emails enviados
```

---

## ğŸ“± **Sistema PWA y Notificaciones Avanzado**

### ğŸ¯ **PWA Tracking Completo**
**Sistema de seguimiento de instalaciones y uso de Progressive Web App:**

- **ğŸ“Š DetecciÃ³n AutomÃ¡tica**: Detecta usuarios que ya tienen PWA instalada (retroactivo)
- **ğŸ“± Tracking en Tiempo Real**: Registra instalaciones, sesiones, y uso standalone vs web
- **ğŸ” MÃºltiples MÃ©todos de DetecciÃ³n**:
  - Modo standalone directo (iOS Safari, Android Chrome)
  - API `getInstalledRelatedApps` (Chrome/Edge)
  - HeurÃ­stica de ausencia de install prompt
  - AnÃ¡lisis de patrones de uso frecuente
- **ğŸ“ˆ MÃ©tricas Reales**: ConversiÃ³n de prompts a instalaciones, duraciÃ³n de sesiones
- **ğŸ¯ Admin Panel Completo**: `/admin/pwa` con estadÃ­sticas detalladas

### ğŸ”” **Push Notifications Analytics**
**Sistema avanzado de anÃ¡lisis de notificaciones push:**

- **ğŸ‘¥ GestiÃ³n de Usuarios**: Tracking completo de permisos y suscripciones
- **ğŸ“Š Analytics Detalladas**:
  - Usuarios con permisos concedidos vs suscripciones activas
  - Click-through rates por tipo de notificaciÃ³n
  - DistribuciÃ³n por dispositivos y navegadores
  - Tendencias diarias y patrones de uso
- **ğŸ¯ Targeting Inteligente**: IdentificaciÃ³n de usuarios listos para recibir notificaciones
- **ğŸ“ˆ Admin Panels**: 
  - `/admin/notificaciones` - Overview general
  - `/admin/notificaciones/push` - AnÃ¡lisis detallado
  - `/admin/notificaciones/push/usuarios` - GestiÃ³n de usuarios

### ğŸ“Š **Datos Reales vs Estimaciones**
**Todos los paneles muestran datos 100% reales:**

- **âŒ Antes**: "PWAs Estimadas ~32% de usuarios activos"
- **âœ… Ahora**: "PWAs Instaladas: X (datos reales)"
- **âŒ Antes**: "Push Estimados ~15% usuarios registrados"  
- **âœ… Ahora**: "Push Activos: Y (suscripciones push)"

### ğŸ”§ **ImplementaciÃ³n TÃ©cnica**
- **Service Worker**: `/public/sw.js` - Manejo completo de notificaciones
- **PWA Tracker**: `/lib/services/pwaTracker.js` - DetecciÃ³n y tracking automÃ¡tico
- **Notification Tracker**: `/lib/services/notificationTracker.js` - Analytics push
- **Base de Datos**: Tablas `pwa_events`, `pwa_sessions`, `notification_events`
- **Admin Components**: Componentes especializados para cada tipo de anÃ¡lisis

---

## ğŸ“‹ **Nuevas Tablas Clave Implementadas**

### ğŸ†• **Table: `article_exam_stats`** - Arquitectura HÃ­brida â­ *REVOLUCIONARIO*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del registro |
| `article_id` | uuid (FK) | Referencia al artÃ­culo |
| `oposicion_id` | uuid (FK) | Referencia a la oposiciÃ³n |
| `total_appearances` | integer | Total de apariciones en exÃ¡menes |
| `years_appeared` | integer[] | Array de aÃ±os en que apareciÃ³ [2021,2022,2023] |
| `first_appearance` | integer | Primer aÃ±o de apariciÃ³n |
| `last_appearance` | integer | Ãšltimo aÃ±o de apariciÃ³n |
| `classification` | text | ClasificaciÃ³n: VERY_FREQUENT, FREQUENT, OCCASIONAL |
| `user_message` | text | Mensaje para el usuario: "âš¡ Â¡MEMORIZA LITERALMENTE!" |
| `source_table` | text | Tabla de origen de los datos |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

**CONSTRAINT ÃšNICO:** `(article_id, oposicion_id)` - Imposible tener duplicados

### ğŸ†• **Table: `law_versions`** - Control de Versiones â­ *NUEVO*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la versiÃ³n |
| `law_id` | uuid (FK) | Referencia a la ley |
| `version_number` | text | NÃºmero de versiÃ³n (ej: "1.0", "1.1") |
| `content_hash` | text | Hash SHA-256 de todo el contenido |
| `boe_reference` | text | Referencia oficial del BOE |
| `change_description` | text | DescripciÃ³n de los cambios realizados |
| `verification_date` | date | Fecha de verificaciÃ³n |
| `next_verification_date` | date | PrÃ³xima fecha de verificaciÃ³n programada |
| `verification_priority` | text | Prioridad: URGENT, HIGH, MEDIUM, LOW |
| `is_current_version` | boolean | Si es la versiÃ³n actual |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

### ğŸ†• **Table: `article_versions`** - Historial de ArtÃ­culos â­ *NUEVO*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la versiÃ³n |
| `article_id` | uuid (FK) | Referencia al artÃ­culo |
| `law_version_id` | uuid (FK) | Referencia a la versiÃ³n de la ley |
| `version_number` | text | NÃºmero de versiÃ³n del artÃ­culo |
| `content_hash` | text | Hash SHA-256 del contenido del artÃ­culo |
| `content` | text | Contenido histÃ³rico del artÃ­culo |
| `change_description` | text | DescripciÃ³n especÃ­fica del cambio |
| `verification_date` | date | Fecha de verificaciÃ³n del artÃ­culo |
| `is_current_version` | boolean | Si es la versiÃ³n actual del artÃ­culo |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

---

## ğŸ”§ Funciones SQL Implementadas

### ğŸ“ˆ Funciones SQL Operativas â­ *25+ FUNCIONES AVANZADAS*
```
âœ… GENERACIÃ“N DE TESTS:
â”œâ”€â”€ get_topic_questions_v2() - Preguntas por tema
â”œâ”€â”€ generate_test_by_topic() - Generador de tests dinÃ¡micos
â”œâ”€â”€ get_article_questions() - Preguntas especÃ­ficas por artÃ­culo

âœ… EXÃMENES OFICIALES â­ IMPLEMENTADO:
â”œâ”€â”€ get_examen_oficial_exacto() - Recrear examen oficial completo
â”œâ”€â”€ get_preguntas_oficiales_por_tema() - Solo preguntas que cayeron
â”œâ”€â”€ get_estadisticas_examenes_oficiales() - Stats de cobertura
â”œâ”€â”€ get_articles_missing_questions() - Prioridades para crear preguntas

âœ… CONTEXTO INTELIGENTE â­ IMPLEMENTADO:
â”œâ”€â”€ get_question_exam_context_v2() - Contexto histÃ³rico por oposiciÃ³n
â”œâ”€â”€ get_article_context_final() - FunciÃ³n hÃ­brida optimizada
â”œâ”€â”€ get_oposicion_articles() - ArtÃ­culos de una oposiciÃ³n especÃ­fica
â”œâ”€â”€ get_oposicion_coverage_stats() - EstadÃ­sticas de cobertura

âœ… CONTROL DE VERSIONES â­ NUEVO:
â”œâ”€â”€ generate_content_hash() - GeneraciÃ³n de hashes SHA-256
â”œâ”€â”€ check_law_update_needed() - Verificar si ley necesita actualizaciÃ³n
â”œâ”€â”€ get_laws_needing_verification() - Leyes pendientes de verificaciÃ³n
â”œâ”€â”€ migrate_existing_exam_data() - MigraciÃ³n de datos histÃ³ricos

âœ… ANÃLISIS Y ESTADÃSTICAS:
â”œâ”€â”€ get_question_stats_by_position() - EstadÃ­sticas por oposiciÃ³n
â”œâ”€â”€ get_official_exam_coverage_stats() - Cobertura exÃ¡menes oficiales
â”œâ”€â”€ get_user_progress_analytics() - Analytics de progreso de usuario
â”œâ”€â”€ get_recommendation_engine() - Motor de recomendaciones

âœ¨ SISTEMA IA ADAPTATIVO â­ NUEVO:
â”œâ”€â”€ calculate_personal_difficulty() - Algoritmo de dificultad personal
â”œâ”€â”€ calculate_trend() - AnÃ¡lisis de tendencias de progreso
â”œâ”€â”€ update_user_question_history() - Trigger automÃ¡tico de actualizaciÃ³n
â”œâ”€â”€ migrate_existing_data() - MigraciÃ³n de datos histÃ³ricos
â”œâ”€â”€ get_personal_difficulty_breakdown() - DistribuciÃ³n personal
â””â”€â”€ get_personalized_recommendations() - Recomendaciones IA
```

---

## ğŸ“‹ **DocumentaciÃ³n Completa de Tablas**

### ğŸ“š **CONTENIDO LEGAL**

#### ğŸ›ï¸ **Table: `laws`** - Normativa Legal
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la ley |
| `name` | text | Nombre completo oficial (ej: "ConstituciÃ³n EspaÃ±ola de 1978") |
| `short_name` | text | Nombre abreviado para referencias (ej: "CE", "LPAC") |
| `year` | integer | AÃ±o de promulgaciÃ³n de la ley |
| `type` | text | Tipo de norma: "constitucional", "ley_organica", "ley_ordinaria", "real_decreto" |
| `scope` | text | Ãmbito de aplicaciÃ³n: "nacional", "autonomico", "local" |
| `description` | text | DescripciÃ³n y objeto de la ley |
| `is_active` | boolean | Si la ley estÃ¡ vigente y disponible para tests |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“– **Table: `articles`** - ArtÃ­culos EspecÃ­ficos
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del artÃ­culo |
| `law_id` | uuid (FK) | Referencia a la ley a la que pertenece |
| `article_number` | text | NÃºmero del artÃ­culo (ej: "103", "104", "bis") |
| `title` | text | TÃ­tulo o epÃ­grafe del artÃ­culo |
| `content` | text | Contenido completo del artÃ­culo |
| `title_number` | text | NÃºmero del tÃ­tulo al que pertenece (estructura jerÃ¡rquica) |
| `chapter_number` | text | NÃºmero del capÃ­tulo al que pertenece |
| `section_number` | text | NÃºmero de la secciÃ³n al que pertenece |
| `content_hash` | text | Hash SHA-256 del contenido para control de versiones |
| `verification_date` | date | Fecha de Ãºltima verificaciÃ³n |
| `is_verified` | boolean | Si el contenido ha sido verificado |
| `is_active` | boolean | Si el artÃ­culo estÃ¡ disponible para tests |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“š **Table: `topics`** - Temas de Oposiciones
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del tema |
| `position_type` | text | Tipo de oposiciÃ³n: "auxiliar_administrativo", "administrativo_c1", etc. |
| `topic_number` | integer | NÃºmero del tema dentro de la oposiciÃ³n (1, 2, 3...) |
| `name` | text | Nombre completo del tema (ej: "Tema 5: La AdministraciÃ³n PÃºblica") |
| `description` | text | DescripciÃ³n detallada del contenido del tema |
| `difficulty` | text | Nivel de dificultad: "facil", "medio", "dificil" |
| `estimated_hours` | numeric | Horas estimadas de estudio para dominar el tema |
| `is_active` | boolean | Si el tema estÃ¡ disponible para tests |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ—‚ï¸ **Table: `topic_scope`** - Mapeo Tema â†” ArtÃ­culos â­ *CLAVE*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del mapeo |
| `topic_id` | uuid (FK) | Referencia al tema |
| `law_id` | uuid (FK) | Referencia a la ley |
| `article_numbers` | text[] | Array de nÃºmeros de artÃ­culos especÃ­ficos ['103', '104', '105'] |
| `title_numbers` | text[] | Array de tÃ­tulos completos a incluir |
| `chapter_numbers` | text[] | Array de capÃ­tulos completos a incluir |
| `include_full_title` | boolean | Si incluir todo el tÃ­tulo completo |
| `include_full_chapter` | boolean | Si incluir todo el capÃ­tulo completo |
| `weight` | numeric | Peso/importancia del contenido en el tema (0.1-1.0) |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

---

### â“ **PREGUNTAS Y TESTS**

#### â“ **Table: `questions`** - Preguntas Reutilizables â­ *ARQUITECTURA REVOLUCIONARIA*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la pregunta |
| `primary_article_id` | uuid (FK) | **CLAVE**: ArtÃ­culo principal al que se refiere (reutilizaciÃ³n) |
| `question_text` | text | Texto completo de la pregunta |
| `option_a` | text | OpciÃ³n A de respuesta |
| `option_b` | text | OpciÃ³n B de respuesta |
| `option_c` | text | OpciÃ³n C de respuesta |
| `option_d` | text | OpciÃ³n D de respuesta |
| `correct_option` | text | OpciÃ³n correcta: "a", "b", "c", "d" |
| `explanation` | text | ExplicaciÃ³n detallada de por quÃ© es correcta |
| `difficulty` | text | Dificultad: "facil", "medio", "dificil" |
| `question_type` | text | Tipo: "teorica", "practica", "caso_practico" |
| `tags` | text[] | Etiquetas para categorizaciÃ³n ['principios', 'competencias'] |
| `is_active` | boolean | Si la pregunta estÃ¡ disponible para tests |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“Š **Table: `test_configurations`** - Configuraciones de Tests
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la configuraciÃ³n |
| `user_id` | uuid (FK) | Usuario propietario de la configuraciÃ³n |
| `name` | text | Nombre de la configuraciÃ³n (ej: "Tema 5 - Repaso falladas") |
| `topic_id` | uuid (FK) | Tema principal del test (puede ser NULL para tests mixtos) |
| `total_questions` | integer | NÃºmero total de preguntas del test |
| `question_distribution` | text | DistribuciÃ³n: "only_unseen_questions", "mixed", "failed_only" |
| `only_unseen_questions` | boolean | Solo preguntas nunca vistas por el usuario |
| `time_limit_minutes` | integer | LÃ­mite de tiempo en minutos (NULL = sin lÃ­mite) |
| `is_completed` | boolean | Si el test ha sido completado |
| `created_at` | timestamp | Fecha de creaciÃ³n de la configuraciÃ³n |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n de la configuraciÃ³n |

#### ğŸ”— **Table: `test_questions`** - RelaciÃ³n Tests â†” Preguntas
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la relaciÃ³n |
| `test_id` | uuid (FK) | Referencia al test |
| `question_id` | uuid (FK) | Referencia a la pregunta |
| `question_order` | integer | Orden de la pregunta en el test (1, 2, 3...) |
| `user_answer` | text | Respuesta del usuario: "a", "b", "c", "d" |
| `is_correct` | boolean | Si la respuesta fue correcta |
| `fixacion` | text | Nivel de fijaciÃ³n del conocimiento |
| `time_spent_seconds` | integer | Tiempo empleado en responder (segundos) |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“ **Table: `tests`** - Sesiones de Tests
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del test |
| `user_id` | uuid (FK) | Usuario que realizÃ³ el test |
| `title` | text | TÃ­tulo del test (ej: "Test Tema 5 - 25 preguntas") |
| `test_type` | text | Tipo: "practice", "official_exam", "mixed" |
| `total_questions` | integer | NÃºmero total de preguntas |
| `time_limit_minutes` | integer | Tiempo lÃ­mite establecido |
| `started_at` | timestamp | Fecha/hora de inicio del test |
| `completed_at` | timestamp | Fecha/hora de finalizaciÃ³n (NULL si no terminado) |
| `is_completed` | boolean | Si el test fue completado |
| `score` | numeric | PuntuaciÃ³n obtenida (0-100) |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

---

### ğŸ¯ **EXÃMENES OFICIALES** â­ *IMPLEMENTADO*

#### ğŸ† **Table: `oposiciones`** - Tipos de Oposiciones
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la oposiciÃ³n |
| `nombre` | text | Nombre oficial completo (ej: "Auxiliar Administrativo del Estado") |
| `tipo_acceso` | text | Tipo de acceso: "libre", "promocion_interna" |
| `administracion` | text | AdministraciÃ³n: "estado", "autonomica", "local" |
| `categoria` | text | CategorÃ­a profesional: "C2", "C1", "A2", "A1" |
| `descripcion` | text | DescripciÃ³n de las funciones del puesto |
| `is_active` | boolean | Si la oposiciÃ³n estÃ¡ activa para tests |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“… **Table: `convocatorias`** - Convocatorias por AÃ±o
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la convocatoria |
| `oposicion_id` | uuid (FK) | Referencia a la oposiciÃ³n |
| `aÃ±o` | integer | AÃ±o de la convocatoria (2023, 2022, 2021...) |
| `fecha_examen` | date | Fecha en que se celebrÃ³ el examen |
| `boe_numero` | text | NÃºmero del BOE de la convocatoria |
| `plazas_convocadas` | integer | NÃºmero de plazas ofertadas |
| `observaciones` | text | Detalles adicionales (nota de corte, incidencias, etc.) |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ”¥ **Table: `articulos_examenes`** - Historial de ArtÃ­culos â­ *INTELIGENCIA*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del registro |
| `convocatoria_id` | uuid (FK) | Referencia a la convocatoria especÃ­fica |
| `article_id` | uuid (FK) | Referencia al artÃ­culo que apareciÃ³ |
| `frecuencia_aparicion` | integer | NÃºmero de veces que apareciÃ³ en esa convocatoria |
| `tipo_pregunta` | text | Tipo: "teorica", "practica", "caso_practico" |
| `puntos_pregunta` | numeric | Puntos que valÃ­a la pregunta (si se conoce) |
| `observaciones` | text | Contexto adicional sobre la apariciÃ³n |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“ **Table: `preguntas_examenes_oficiales`** - Preguntas Exactas â­ *REVOLUCIONARIO*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la pregunta oficial |
| `convocatoria_id` | uuid (FK) | Referencia a la convocatoria especÃ­fica |
| `numero_pregunta` | integer | NÃºmero de la pregunta en el examen (1, 2, 3... hasta 60) |
| `parte_examen` | text | Parte: "organizacion_publica", "ofimatica", "psicotecnico" |
| `pregunta_text` | text | **TEXTO EXACTO** de la pregunta oficial |
| `opcion_a` | text | OpciÃ³n A exacta del examen oficial |
| `opcion_b` | text | OpciÃ³n B exacta del examen oficial |
| `opcion_c` | text | OpciÃ³n C exacta del examen oficial |
| `opcion_d` | text | OpciÃ³n D exacta del examen oficial |
| `respuesta_correcta` | text | Respuesta correcta oficial: "a", "b", "c", "d" |
| `article_id` | uuid (FK) | ArtÃ­culo al que se refiere (NULL para psicotÃ©cnicas) |
| `topic_estimado` | text | Tema estimado al que pertenece |
| `explicacion` | text | ExplicaciÃ³n de la respuesta correcta |
| `fue_anulada` | boolean | Si la pregunta fue anulada oficialmente |
| `observaciones` | text | Contexto adicional sobre la pregunta |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ”— **Table: `oposicion_topics`** - Mapeo OposiciÃ³n â†” Temas
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del mapeo |
| `oposicion_id` | uuid (FK) | Referencia a la oposiciÃ³n |
| `topic_id` | uuid (FK) | Referencia al tema |
| `es_tema_principal` | boolean | Si es un tema principal o complementario |
| `peso_examen` | numeric | Peso del tema en el examen (% aproximado) |
| `observaciones` | text | Notas sobre la importancia del tema |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ¯ **Table: `oposicion_articles`** - Mapeo Directo OposiciÃ³n â†” ArtÃ­culos
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del mapeo |
| `oposicion_id` | uuid (FK) | Referencia a la oposiciÃ³n |
| `article_id` | uuid (FK) | Referencia al artÃ­culo |
| `importancia` | text | Importancia: "alta", "media", "baja" |
| `observaciones` | text | Contexto sobre por quÃ© estÃ¡ en esta oposiciÃ³n |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

---

### ğŸ†• **ARQUITECTURA HÃBRIDA** â­ *REVOLUCIONARIO*

#### ğŸš€ **Table: `article_exam_stats`** - EstadÃ­sticas Optimizadas â­ *NUEVO*
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del registro |
| `article_id` | uuid (FK) | Referencia al artÃ­culo |
| `oposicion_id` | uuid (FK) | Referencia a la oposiciÃ³n |
| `total_appearances` | integer | Total de apariciones en exÃ¡menes |
| `years_appeared` | integer[] | Array de aÃ±os en que apareciÃ³ [2021,2022,2023] |
| `first_appearance` | integer | Primer aÃ±o de apariciÃ³n |
| `last_appearance` | integer | Ãšltimo aÃ±o de apariciÃ³n |
| `classification` | text | ClasificaciÃ³n: VERY_FREQUENT, FREQUENT, OCCASIONAL |
| `user_message` | text | Mensaje para el usuario: "âš¡ Â¡MEMORIZA LITERALMENTE!" |
| `source_table` | text | Tabla de origen de los datos para trazabilidad |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

**CONSTRAINT ÃšNICO:** `UNIQUE(article_id, oposicion_id)` - Imposible tener duplicados

---

### ğŸ†• **CONTROL DE VERSIONES** â­ *NUEVO*

#### ğŸ“š **Table: `law_versions`** - Historial de Versiones de Leyes
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la versiÃ³n |
| `law_id` | uuid (FK) | Referencia a la ley |
| `version_number` | text | NÃºmero de versiÃ³n (ej: "1.0", "1.1") |
| `content_hash` | text | Hash SHA-256 de todo el contenido de la ley |
| `boe_reference` | text | Referencia oficial del BOE (ej: "BOE-A-1978-31229") |
| `boe_url` | text | URL directa al BOE consolidado |
| `change_description` | text | DescripciÃ³n de los cambios realizados |
| `verification_date` | date | Fecha de verificaciÃ³n de la versiÃ³n |
| `next_verification_date` | date | PrÃ³xima fecha de verificaciÃ³n programada |
| `verification_priority` | text | Prioridad: URGENT, HIGH, MEDIUM, LOW |
| `is_current_version` | boolean | Si es la versiÃ³n actual |
| `verification_notes` | text | Notas adicionales sobre la verificaciÃ³n |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“– **Table: `article_versions`** - Historial de Versiones de ArtÃ­culos
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la versiÃ³n |
| `article_id` | uuid (FK) | Referencia al artÃ­culo |
| `law_version_id` | uuid (FK) | Referencia a la versiÃ³n de la ley |
| `version_number` | text | NÃºmero de versiÃ³n del artÃ­culo (ej: "1.0", "1.1") |
| `content_hash` | text | Hash SHA-256 del contenido del artÃ­culo |
| `content` | text | Contenido histÃ³rico del artÃ­culo |
| `title` | text | TÃ­tulo histÃ³rico del artÃ­culo |
| `change_description` | text | DescripciÃ³n especÃ­fica del cambio en el artÃ­culo |
| `verification_date` | date | Fecha de verificaciÃ³n del artÃ­culo |
| `is_current_version` | boolean | Si es la versiÃ³n actual del artÃ­culo |
| `change_type` | text | Tipo de cambio: "content", "title", "structure" |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“… **Table: `version_checks`** - ProgramaciÃ³n de Verificaciones
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la verificaciÃ³n |
| `law_id` | uuid (FK) | Referencia a la ley a verificar |
| `check_type` | text | Tipo: "automatic", "manual", "scheduled" |
| `scheduled_date` | date | Fecha programada para la verificaciÃ³n |
| `check_frequency` | text | Frecuencia: "monthly", "quarterly", "yearly" |
| `priority` | text | Prioridad: URGENT, HIGH, MEDIUM, LOW |
| `check_status` | text | Estado: "pending", "completed", "failed" |
| `last_check_date` | date | Fecha de la Ãºltima verificaciÃ³n |
| `next_check_date` | date | Fecha de la prÃ³xima verificaciÃ³n |
| `notification_enabled` | boolean | Si estÃ¡n habilitadas las notificaciones |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ“Š **View: `law_update_status`** - Vista de Estado de ActualizaciÃ³n
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `law_id` | uuid | Identificador de la ley |
| `law_name` | text | Nombre de la ley |
| `short_name` | text | Nombre abreviado |
| `current_version` | text | VersiÃ³n actual |
| `last_verification_date` | date | Ãšltima verificaciÃ³n |
| `next_verification_date` | date | PrÃ³xima verificaciÃ³n |
| `verification_priority` | text | Prioridad de verificaciÃ³n |
| `status_display` | text | Estado para mostrar: "âœ… Actualizada", "âš ï¸ Pendiente", "ğŸš¨ Urgente" |
| `days_until_verification` | integer | DÃ­as hasta prÃ³xima verificaciÃ³n |
| `articles_count` | integer | NÃºmero total de artÃ­culos |
| `articles_with_hash` | integer | ArtÃ­culos con hash generado |

---

### ğŸ‘¤ **USUARIOS Y PROGRESO**

#### ğŸ‘¤ **Table: `user_profiles`** - Perfiles de Usuario
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del perfil |
| `user_id` | uuid (FK) | Referencia al usuario de auth.users |
| `email` | text | Email del usuario |
| `full_name` | text | Nombre completo del usuario |
| `avatar_url` | text | URL del avatar/foto de perfil |
| `preferred_language` | text | Idioma preferido: "es", "en" |
| `study_goal` | text | Objetivo de estudio del usuario |
| `target_oposicion` | text | OposiciÃ³n objetivo del usuario |
| `study_hours_per_day` | numeric | Horas de estudio diarias objetivo |
| `notification_preferences` | jsonb | Preferencias de notificaciones |
| `is_active` | boolean | Si el perfil estÃ¡ activo |
| `created_at` | timestamp | Fecha de creaciÃ³n del perfil |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del perfil |

#### ğŸ“ˆ **Table: `user_progress`** - Progreso Detallado
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico del progreso |
| `user_id` | uuid (FK) | Referencia al usuario |
| `topic_id` | uuid (FK) | Referencia al tema (NULL para progreso general) |
| `law_id` | uuid (FK) | Referencia a la ley (NULL para progreso general) |
| `article_id` | uuid (FK) | Referencia al artÃ­culo especÃ­fico |
| `total_attempts` | integer | NÃºmero total de intentos/preguntas respondidas |
| `correct_attempts` | integer | NÃºmero de respuestas correctas |
| `accuracy_percentage` | numeric | Porcentaje de aciertos (calculado automÃ¡ticamente) |
| `last_attempt_date` | timestamp | Fecha del Ãºltimo intento |
| `needs_review` | boolean | Si necesita repaso (algoritmo automÃ¡tico) |
| `study_time_seconds` | integer | Tiempo total de estudio en segundos |
| `difficulty_level` | text | Nivel de dificultad percibido por el usuario |
| `confidence_level` | text | Nivel de confianza: "low", "medium", "high" |
| `created_at` | timestamp | Fecha de creaciÃ³n del registro |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n del registro |

#### ğŸ’¡ **Table: `user_recommendations`** - Recomendaciones Personalizadas
| Campo | Tipo | DescripciÃ³n |
|-------|------|-------------|
| `id` | uuid (PK) | Identificador Ãºnico de la recomendaciÃ³n |
| `user_id` | uuid (FK) | Referencia al usuario |
| `recommendation_type` | text | Tipo: "topic_review", "article_focus", "exam_simulation" |
| `title` | text | TÃ­tulo de la recomendaciÃ³n |
| `description` | text | DescripciÃ³n detallada de quÃ© hacer |
| `topic_id` | uuid (FK) | Tema recomendado (si aplica) |
| `article_id` | uuid (FK) | ArtÃ­culo recomendado (si aplica) |
| `priority` | text | Prioridad: "alta", "media", "baja" |
| `recommendation_score` | numeric | PuntuaciÃ³n de la recomendaciÃ³n (0-100) |
| `is_dismissed` | boolean | Si el usuario descartÃ³ la recomendaciÃ³n |
| `is_completed` | boolean | Si la recomendaciÃ³n fue completada |
| `expires_at` | timestamp | Fecha de expiraciÃ³n de la recomendaciÃ³n |
| `created_at` | timestamp | Fecha de creaciÃ³n de la recomendaciÃ³n |
| `updated_at` | timestamp | Ãšltima actualizaciÃ³n de la recomendaciÃ³n |

---

## ğŸ”— **Relaciones Clave y Constraints**

### **Constraints Ãšnicos Implementados:**
```sql
-- Garantizar una sola estadÃ­stica por artÃ­culo-oposiciÃ³n
ALTER TABLE article_exam_stats 
ADD CONSTRAINT unique_article_oposicion 
UNIQUE (article_id, oposicion_id);

-- Evitar duplicados en mapeo de temas
ALTER TABLE topic_scope 
ADD CONSTRAINT unique_topic_law_scope 
UNIQUE (topic_id, law_id);

-- Una sola convocatoria por aÃ±o-oposiciÃ³n
ALTER TABLE convocatorias 
ADD CONSTRAINT unique_convocatoria_year 
UNIQUE (oposicion_id, aÃ±o);
```

### **Ãndices de Performance:**
```sql
-- Ãndices para consultas rÃ¡pidas
CREATE INDEX idx_articles_law_number ON articles(law_id, article_number);
CREATE INDEX idx_questions_article ON questions(primary_article_id);
CREATE INDEX idx_article_stats_classification ON article_exam_stats(classification);
CREATE INDEX idx_article_versions_current ON article_versions(article_id, is_current_version);
CREATE INDEX idx_user_progress_article ON user_progress(user_id, article_id);
```

### **Triggers Implementados:**
```sql
-- Actualizar hash automÃ¡ticamente cuando cambia content
CREATE TRIGGER update_article_hash 
BEFORE UPDATE ON articles 
FOR EACH ROW EXECUTE FUNCTION update_content_hash();

-- Sincronizar article_exam_stats cuando cambia articulos_examenes
CREATE TRIGGER sync_exam_stats 
AFTER INSERT OR UPDATE ON articulos_examenes 
FOR EACH ROW EXECUTE FUNCTION sync_article_exam_stats();
```

## ğŸš€ Casos de Uso Revolucionarios

### ğŸ“– Tests Personalizados Avanzados
```
"Test Tema 5 - 25 preguntas aleatorias"
"Test Tema 7 - 20 falladas + 5 aleatorias"
"Test Art. 103 CE especÃ­fico - 10 preguntas"
"Test solo preguntas nunca vistas - 50 preguntas"
"Simulacro oficial - 100 preguntas mixtas"
"Repaso errores Ãºltima semana"
"Test TÃ­tulo Preliminar CE - 15 preguntas"
"Test CapÃ­tulo II SecciÃ³n 1Âª - Derechos fundamentales"
```

### âœ¨ **Modo Adaptativo (IMPLEMENTADO)** â­ *NUEVO*
```
Usuario iniciando test con 25 preguntas:
â”œâ”€â”€ Pregunta 1: âœ… Correcta (100% aciertos)
â”œâ”€â”€ Pregunta 2: âŒ Incorrecta (50% aciertos)
â”œâ”€â”€ Pregunta 3: âŒ Incorrecta (33% aciertos)
â””â”€â”€ ğŸ¯ SISTEMA DETECTA: <60% â†’ Activa modo adaptativo

Indicador visual automÃ¡tico:
â”œâ”€â”€ âœ¨ "AdaptÃ¡ndose a tu nivel" (con animaciÃ³n pulse)
â”œâ”€â”€ Mensaje: "âœ¨ Adaptando las preguntas a tu nivel (33% aciertos)"
â””â”€â”€ Usuario sabe que el sistema estÃ¡ optimizando su experiencia
```

### ğŸ¯ **ExÃ¡menes Oficiales (IMPLEMENTADO)** â­ *GAME CHANGER*
```
"Examen Oficial 2023 - 17 septiembre (EXACTO)"
â”œâ”€â”€ 60 preguntas IDÃ‰NTICAS a las que aparecieron
â”œâ”€â”€ Mismas opciones, mismo orden
â”œâ”€â”€ Experiencia 100% real del examen oficial
â””â”€â”€ CorrecciÃ³n automÃ¡tica con plantilla oficial

"Tema 5 - Solo preguntas oficiales"  
â”œâ”€â”€ Art. 103 CE â†’ "CayÃ³ en 2023, 2022, 2021" (VERY_FREQUENT)
â”œâ”€â”€ Art. 104 CE â†’ "CayÃ³ en 2023" (OCCASIONAL)
â””â”€â”€ Solo preguntas que HAN APARECIDO en exÃ¡menes reales

"Simulacro EstratÃ©gico"
â”œâ”€â”€ Prioriza artÃ­culos VERY_FREQUENT  
â”œâ”€â”€ DistribuciÃ³n realista por temas
â””â”€â”€ Enfoque en contenido que "cae seguro"
```

### ğŸ†• **Control de Versiones (NUEVO)** â­ *INTEGRIDAD GARANTIZADA*
```
"VerificaciÃ³n AutomÃ¡tica de Leyes"
â”œâ”€â”€ Hash CE: a3f5d9e8... âœ… Verificada 2024-12-26
â”œâ”€â”€ Hash LPAC: b2e4c7f1... âš ï¸ Pendiente verificaciÃ³n
â”œâ”€â”€ Hash LRJSP: c5d8a2b9... ğŸš¨ Necesita actualizaciÃ³n
â””â”€â”€ Alertas automÃ¡ticas por prioridad

"Trazabilidad Completa"
â”œâ”€â”€ Art. 103 CE v1.0 â†’ Hash: xyz123... (2024-01-15)
â”œâ”€â”€ Art. 103 CE v1.1 â†’ Hash: abc456... (2024-06-20)
â””â”€â”€ Historial completo de cambios detectados

"FunciÃ³n de Consulta RÃ¡pida"
â”œâ”€â”€ get_article_context_final('103', 'Auxiliar')
â”œâ”€â”€ Resultado: FREQUENT, 3 apariciones, "ğŸ“š Repasar bien"
â””â”€â”€ Performance optimizada con arquitectura hÃ­brida
```

### ğŸ¯ Mapeo Inteligente Implementado
```
âœ… Tema 5 Auxiliar Administrativo:
â”œâ”€â”€ CE Art. 103, 104, 105
â”œâ”€â”€ 4 preguntas reutilizables cargadas
â””â”€â”€ ğŸ”¥ Art. 103 = "FREQUENT" (3 apariciones histÃ³ricas)

âœ… Tema 7 Auxiliar Administrativo:
â”œâ”€â”€ Ley 19/2013 Art. 1,2,3,5,12,13,14,24,25,26,33,37
â”œâ”€â”€ 12 artÃ­culos fundamentales mapeados
â””â”€â”€ ğŸ”¥ Art. 13, 14 = "FREQUENT" (2 apariciones cada uno)

â³ Tema 1:
â”œâ”€â”€ CE TÃ­tulo Preliminar (Art. 1-9)
â”œâ”€â”€ CE TÃ­tulo I, CapÃ­tulo II, SecciÃ³n 1Âª
â””â”€â”€ Pendiente de mapear
```

### ğŸ”„ **ReutilizaciÃ³n Inteligente** â­ *IMPLEMENTADO*
```
Art. 103 CE â†’ 4 preguntas creadas
â”œâ”€â”€ âœ… Auxiliar Administrativo Tema 5 (las usa automÃ¡ticamente)
â”œâ”€â”€ â³ Administrativo C1 Tema 8 (las reutilizarÃ¡ cuando se configure)
â”œâ”€â”€ â³ GestiÃ³n Procesal Tema 12 (las reutilizarÃ¡ cuando se configure)
â””â”€â”€ â³ Cualquier nueva oposiciÃ³n (reutilizaciÃ³n automÃ¡tica)

Contexto diferenciado por oposiciÃ³n:
â”œâ”€â”€ Auxiliar Admin: "ğŸ¯ FREQUENT - 3 apariciones (Ãºltima: 2023)"
â”œâ”€â”€ Admin C1: "ğŸ“ OCCASIONAL - 1 apariciÃ³n (2022)"
â””â”€â”€ GestiÃ³n Procesal: (Sin contexto - no ha caÃ­do en esa oposiciÃ³n)
```

### ğŸ¯ **Contexto de ExÃ¡menes Oficiales** â­ *ARQUITECTURA HÃBRIDA*
```
Art. 103 CE en examen Auxiliar Administrativo:
â”œâ”€â”€ ğŸ“Š Historial: [2021,2022,2023] (3 apariciones)
â”œâ”€â”€ ğŸ¯ ClasificaciÃ³n: FREQUENT
â”œâ”€â”€ ğŸ“¢ Mensaje: "ğŸ“š Repasar bien"
â””â”€â”€ âš¡ Consulta hÃ­brida optimizada

Art. 13 Ley 19/2013 en examen Auxiliar Administrativo:
â”œâ”€â”€ ğŸ“Š Historial: [2022,2023] (2 apariciones)
â”œâ”€â”€ ğŸ¯ ClasificaciÃ³n: FREQUENT
â”œâ”€â”€ ğŸ“¢ Mensaje: "ğŸ“š Repasar bien"
â””â”€â”€ ğŸ”„ Datos consolidados sin duplicados

Art. 50 CE en examen Auxiliar Administrativo:
â”œâ”€â”€ âŒ No estÃ¡ en temario Auxiliar
â””â”€â”€ ğŸ”‡ Sin contexto (no se muestra)
```

---

## ğŸ”§ Stack TecnolÃ³gico

### Frontend (Existente)
- **Next.js 14** con App Router
- **Tailwind CSS** para estilos
- **Componentes React** para interactividad

### Backend (Implementado)
- **Supabase** como backend-as-a-service
- **PostgreSQL** con 21 tablas especializadas
- **19 funciones SQL** para lÃ³gica de negocio
- **Row Level Security** para privacidad
- **ğŸ†• Sistema de hashes** para integridad de datos
- **ğŸ†• Control de versiones** automatizado

### AutenticaciÃ³n y Usuarios
- **Supabase Auth** con Google OAuth
- **Perfiles de usuario** persistentes
- **Progreso multiplataforma**

### Analytics e Inteligencia
- **Sistema de recomendaciones** basado en IA
- **AnÃ¡lisis predictivo** de rendimiento
- **Contexto histÃ³rico** de exÃ¡menes oficiales
- **ğŸ†• Arquitectura hÃ­brida** para performance optimizada
- **ğŸ†• Control de integridad** automÃ¡tico

---

## ğŸ“Š MÃ©tricas de Ã‰xito

### Para Usuarios
- **RetenciÃ³n:** Sesiones recurrentes de estudio
- **Progreso:** Mejora medible en puntuaciones
- **Engagement:** Tiempo de estudio por sesiÃ³n
- **SatisfacciÃ³n:** CompletaciÃ³n de tests largos
- **ğŸ†• Estrategia:** Enfoque optimizado en artÃ­culos "VERY_FREQUENT"
- **ğŸ†• Confianza:** Experiencia real con exÃ¡menes oficiales exactos
- **ğŸ†• Fiabilidad:** Contenido siempre actualizado automÃ¡ticamente

### Para el Sistema
- **Calidad de preguntas:** Tasa de aciertos por pregunta
- **Dificultad real:** AnÃ¡lisis estadÃ­stico de errores
- **Patrones de uso:** Horarios y frecuencia de estudio
- **Contenido efectivo:** QuÃ© temas/leyes generan mÃ¡s engagement
- **ğŸ†• PrecisiÃ³n histÃ³rica:** CorrelaciÃ³n exÃ¡menes oficiales vs. predicciones
- **ğŸ†• ReutilizaciÃ³n:** Tasa de reutilizaciÃ³n de preguntas entre oposiciones
- **ğŸ†• Integridad:** 100% de contenido verificado y actualizado

---

## ğŸ› ï¸ Estado de ImplementaciÃ³n

### Fase 1: Infraestructura Base âœ… **COMPLETADO**
- âœ… ConfiguraciÃ³n de Supabase (Project ID: yqbpstxowvgipqspqrgo)
- âœ… DiseÃ±o de esquema de base de datos (**21 tablas principales**)
- âœ… **Arquitectura de preguntas reutilizables** implementada
- âœ… Sistema de mapeo tema â†’ contenido legal (topic_scope)
- âœ… **19 funciones SQL especializadas** funcionando
- âœ… **Nueva arquitectura questions â†’ articles** (no topics)
- âœ… **ğŸ†• Sistema completo de exÃ¡menes oficiales**
- âœ… **ğŸ†• Contexto histÃ³rico inteligente por oposiciÃ³n**
- âœ… **ğŸ†• Control de versiones completo** con hashes SHA-256
- âœ… **ğŸ†• Arquitectura hÃ­brida** para performance optimizada

### Fase 2: Contenido Legal âœ… **HISTÃ“RICO - COMPLETADO**
- âœ… **ğŸ‰ ConstituciÃ³n EspaÃ±ola COMPLETA** - **169/169 artÃ­culos** (100%)
- âœ… **ğŸ“Š Estructura jerÃ¡rquica completa** - TÃ­tulos, CapÃ­tulos, Secciones
- âœ… **ğŸ›ï¸ Texto consolidado oficial BOE** - Incluye reformas 1992 y 2011
- âœ… **ğŸ†• Hashes SHA-256** generados para todos los artÃ­culos
- âœ… **ğŸ†• Sistema de verificaciÃ³n** automÃ¡tica implementado
- âœ… **ğŸ†• Control de duplicados** resuelto definitivamente
- âœ… **Ley 19/2013 de Transparencia** completa (12 artÃ­culos clave)
- âœ… **Tema 7 Auxiliar Administrativo** mapeado completamente
- âœ… **Tema 5 Auxiliar Administrativo** mapeado parcialmente
- âœ… **ğŸ†• 4 oposiciones configuradas** con mapeo de temas
- âœ… **ğŸ†• Historial exÃ¡menes 2021-2023** para mÃºltiples artÃ­culos
- âœ… **ğŸ†• 5 artÃ­culos confirmados** en examen oficial 2023
- â³ LPAC y LRJSP principales artÃ­culos
- â³ **ğŸ†• MÃ¡s exÃ¡menes oficiales** (2021, 2022) para historial completo

### Fase 3: Preguntas y ExÃ¡menes âœ… **REVOLUCIONARIO**
- âœ… **4 preguntas sÃºper difÃ­ciles** Art. 103 CE implementadas
- âœ… **Arquitectura de reutilizaciÃ³n** funcionando perfectamente
- âœ… **ğŸ†• Sistema de exÃ¡menes oficiales exactos** implementado
- âœ… **ğŸ†• 2 preguntas oficiales reales** del examen 2023 registradas
- âœ… **ğŸ†• Contexto histÃ³rico** integrado en todas las preguntas
- âœ… **ğŸ†• Tabla preguntas_examenes_oficiales** creada y operativa
- âœ… **ğŸ†• Arquitectura hÃ­brida article_exam_stats** funcionando
- âœ… **ğŸ†• Sistema sin duplicados** garantizado con constraints Ãºnicos
- âœ… **ğŸ†• FunciÃ³n optimizada** get_article_context_final() operativa
- â³ Completar 25 preguntas Arts. 103, 104, 105 CE
- â³ Preguntas para Ley 19/2013 de Transparencia
- â³ **ğŸ†• Encontrar y registrar** las 60 preguntas completas del examen 2023
- â³ MigraciÃ³n de preguntas hardcodeadas existentes (Tema 6)
- â³ **ğŸ†• Crear preguntas masivas** para artÃ­culos CE mÃ¡s importantes

### Fase 4: Frontend y Funcionalidad â³ **PENDIENTE**
- âœ… **âœ¨ Modo Adaptativo** - Sistema automÃ¡tico que se ajusta al rendimiento (Sept 2025)
- â³ Sistema de autenticaciÃ³n con Google OAuth
- â³ GeneraciÃ³n dinÃ¡mica de tests en React
- â³ Dashboard de progreso y configuraciones
- â³ IntegraciÃ³n del generador con la UI existente
- â³ **ğŸ†• Botones "Solo preguntas oficiales"** para cada tema
- â³ **ğŸ†• BotÃ³n "Examen Oficial 2023 Completo"**
- â³ **ğŸ†• Badges y contexto visual** para artÃ­culos histÃ³ricos
- â³ **ğŸ†• Dashboard de estadÃ­sticas** de exÃ¡menes oficiales
- â³ **ğŸ†• Tests por estructura:** "Solo TÃ­tulo Preliminar", "Solo CapÃ­tulo II SecciÃ³n 1Âª"
- â³ **ğŸ†• Panel de control de versiones** para administradores
- â³ **ğŸ†• Alertas visuales** de contenido desactualizado

### Fase 5: Features Avanzadas â³ **PENDIENTE**
- â³ Recomendaciones automÃ¡ticas inteligentes
- â³ Tests adaptativos segÃºn rendimiento
- â³ Analytics detallados por estructura legal
- â³ Panel de administraciÃ³n para gestiÃ³n de contenido
- â³ **ğŸ†• Predicciones de exÃ¡menes** basadas en patrones histÃ³ricos
- â³ **ğŸ†• Modo "Simulacro estratÃ©gico"** con peso histÃ³rico
- â³ **ğŸ†• API para bÃºsqueda** de mÃ¡s exÃ¡menes oficiales
- â³ **ğŸ†• Sistema de alertas** para nuevos exÃ¡menes publicados
- â³ **ğŸ†• VerificaciÃ³n automÃ¡tica BOE** para actualizaciones
- â³ **ğŸ†• Dashboard de integridad** de datos

---

## ğŸ“Š Estado Actual de Datos

### âœ… **Base de Datos (21 tablas):**
```
ğŸ“š CONTENIDO LEGAL (4 tablas):
â”œâ”€â”€ laws: 3 leyes principales
â”œâ”€â”€ articles: 169 artÃ­culos CE + 12 Ley 19/2013 = 181+ artÃ­culos
â”œâ”€â”€ topics: 2 temas configurados  
â””â”€â”€ topic_scope: Mapeo inteligente funcionando

ğŸ¯ EXÃMENES OFICIALES (6 tablas): â­ IMPLEMENTADO
â”œâ”€â”€ oposiciones: 4 tipos configurados
â”œâ”€â”€ convocatorias: 3 aÃ±os registrados (2021-2023)
â”œâ”€â”€ articulos_examenes: 5 artÃ­culos con historial
â”œâ”€â”€ preguntas_examenes_oficiales: 2 preguntas reales registradas
â”œâ”€â”€ oposicion_topics: Mapeo oposiciÃ³n â†” temas
â””â”€â”€ oposicion_articles: Mapeo directo funcionando

ğŸ†• ARQUITECTURA HÃBRIDA (1 tabla): â­ REVOLUCIONARIO
â””â”€â”€ article_exam_stats: 4 registros consolidados sin duplicados

ğŸ†• CONTROL DE VERSIONES (4 tablas): â­ NUEVO
â”œâ”€â”€ law_versions: Historial CE completo
â”œâ”€â”€ article_versions: 181+ artÃ­culos con versiones
â”œâ”€â”€ version_checks: Verificaciones programadas
â””â”€â”€ law_update_status: Estado actual 100% actualizado

â“ PREGUNTAS Y TESTS (4 tablas):
â”œâ”€â”€ questions: 4 preguntas reutilizables
â”œâ”€â”€ test_configurations: Estructura preparada
â”œâ”€â”€ test_questions: Sistema operativo
â””â”€â”€ tests: Tracking implementado

ğŸ‘¤ USUARIOS (3 tablas):
â”œâ”€â”€ user_profiles: OAuth preparado
â”œâ”€â”€ user_progress: Analytics funcionando
â””â”€â”€ user_recommendations: Motor preparado
```

### âœ¨ **SISTEMA IA ADAPTATIVO COMPLETO:** â­ *REVOLUCIONARIO*
```
ğŸ§  DIFICULTAD PERSONAL ADAPTATIVA:
â”œâ”€â”€ âœ… 2 tablas principales: user_question_history + user_difficulty_metrics
â”œâ”€â”€ âœ… Algoritmo inteligente: â‰¥85% Ã©xito = Easy personal
â”œâ”€â”€ âœ… Tendencias automÃ¡ticas: improving/declining/stable
â”œâ”€â”€ âœ… Triggers en tiempo real: actualizaciÃ³n automÃ¡tica
â”œâ”€â”€ âœ… API completa: 15+ endpoints especializados
â”œâ”€â”€ âœ… UI componentes: Toggle estÃ¡ndar/personal
â””â”€â”€ âœ… MigraciÃ³n datos: Sistema funcionando 100%

ğŸ’¡ NOTIFICACIONES INTELIGENTES:
â”œâ”€â”€ âœ… 9 tipos motivacionales implementados
â”œâ”€â”€ âœ… AnÃ¡lisis automÃ¡tico de patrones
â”œâ”€â”€ âœ… DetecciÃ³n problemas temprana
â”œâ”€â”€ âœ… MotivaciÃ³n solo cuando aporta valor
â”œâ”€â”€ âœ… Persistencia localStorage + BD
â”œâ”€â”€ âœ… Acciones contextuales directas
â””â”€â”€ âœ… Sistema "Solo MotivaciÃ³n+" activo

ğŸ“Š ANALYTICS VISUALES:
â”œâ”€â”€ âœ… GrÃ¡ficos interactivos de progreso semanal
â”œâ”€â”€ âœ… 4 mÃ©tricas seleccionables (precisiÃ³n, tests, tiempo, preguntas)
â”œâ”€â”€ âœ… AnÃ¡lisis automÃ¡tico de tendencias
â”œâ”€â”€ âœ… Componentes compactos con info desplegable
â”œâ”€â”€ âœ… Iconos IA âœ¨ en toda la aplicaciÃ³n
â””â”€â”€ âœ… UI optimizada para mÃ³vil y desktop
```

### âœ… **ConstituciÃ³n EspaÃ±ola COMPLETA:** â­ *LOGRO HISTÃ“RICO*
```
ğŸ‰ 169/169 ARTÃCULOS MAPEADOS (100%) - Â¡COMPLETADO!
â”œâ”€â”€ ğŸ“š TÃ­tulo Preliminar (Arts. 1-9)
â”œâ”€â”€ ğŸ‘¥ TÃ­tulo I - Derechos y Deberes (Arts. 10-55)
â”‚   â”œâ”€â”€ Cap. I: EspaÃ±oles y extranjeros (10-13)
â”‚   â”œâ”€â”€ Cap. II: Derechos y libertades
â”‚   â”‚   â”œâ”€â”€ Secc. 1Âª: Derechos fundamentales (14-29)
â”‚   â”‚   â””â”€â”€ Secc. 2Âª: Derechos y deberes ciudadanos (30-38)
â”‚   â”œâ”€â”€ Cap. III: Principios rectores (39-52)
â”‚   â”œâ”€â”€ Cap. IV: GarantÃ­as (53-54)
â”‚   â””â”€â”€ Cap. V: SuspensiÃ³n derechos (55)
â”œâ”€â”€ ğŸ‘‘ TÃ­tulo II - La Corona (Arts. 56-65)
â”œâ”€â”€ ğŸ›ï¸ TÃ­tulo III - Cortes Generales (Arts. 66-96)
â”‚   â”œâ”€â”€ Cap. I: Las CÃ¡maras (66-80)
â”‚   â”œâ”€â”€ Cap. II: ElaboraciÃ³n leyes (81-92)
â”‚   â””â”€â”€ Cap. III: Tratados internacionales (93-96)
â”œâ”€â”€ ğŸ›ï¸ TÃ­tulo IV - Gobierno y AdministraciÃ³n (Arts. 97-107)
â”œâ”€â”€ ğŸ¤ TÃ­tulo V - Relaciones Gobierno-Cortes (Arts. 108-116)
â”œâ”€â”€ âš–ï¸ TÃ­tulo VI - Poder Judicial (Arts. 117-127)
â”œâ”€â”€ ğŸ’° TÃ­tulo VII - EconomÃ­a y Hacienda (Arts. 128-136)
â”œâ”€â”€ ğŸ—ºï¸ TÃ­tulo VIII - OrganizaciÃ³n Territorial (Arts. 137-158)
â”‚   â”œâ”€â”€ Cap. I: Principios generales (137-139)
â”‚   â”œâ”€â”€ Cap. II: AdministraciÃ³n Local (140)
â”‚   â””â”€â”€ Cap. III: Comunidades AutÃ³nomas (141-158)
â”œâ”€â”€ âš–ï¸ TÃ­tulo IX - Tribunal Constitucional (Arts. 159-165)
â””â”€â”€ ğŸ”§ TÃ­tulo X - Reforma Constitucional (Arts. 166-169)

ğŸ†• CARACTERÃSTICAS ÃšNICAS:
â”œâ”€â”€ âœ… Contenido consolidado oficial BOE (incluye reformas 1992, 2011)
â”œâ”€â”€ âœ… Estructura jerÃ¡rquica completa (TÃ­tulos â†’ CapÃ­tulos â†’ Secciones)
â”œâ”€â”€ âœ… Hashes SHA-256 para integridad de datos
â”œâ”€â”€ âœ… Control de versiones automÃ¡tico
â”œâ”€â”€ âœ… Sistema de verificaciÃ³n programada
â””â”€â”€ âœ… Zero duplicados garantizado
```

### âœ… **Oposiciones Configuradas:** â­ *IMPLEMENTADO*
- **Auxiliar Administrativo del Estado** (Libre + PromociÃ³n Interna)
- **Administrativo del Estado** (Libre)
- **GestiÃ³n Procesal y Administrativa** (Libre)
- **TramitaciÃ³n Procesal y Administrativa** (Libre)

### âœ… **ExÃ¡menes Oficiales Registrados:** â­ *REVOLUCIONARIO*
- **Convocatorias:** 2021, 2022, 2023 para Auxiliar Administrativo
- **ArtÃ­culos confirmados:** Art. 103, 104 CE + Art. 13, 14 Ley 19/2013 + Art. 38 LRJSP
- **Preguntas exactas:** 2 preguntas reales del examen 17 septiembre 2023
- **Sistema de contexto:** Funcionando al 100%
- **ğŸ†• Arquitectura hÃ­brida:** article_exam_stats optimizada

### âœ… **Control de Versiones Implementado:** â­ *NUEVO*
```
ğŸ“Š ESTADO ACTUAL DE INTEGRIDAD:
â”œâ”€â”€ âœ… ConstituciÃ³n EspaÃ±ola: 169 artÃ­culos con hash generado (100%)
â”œâ”€â”€ âœ… Ley 19/2013: 12 artÃ­culos con hash generado (100%)
â”œâ”€â”€ âœ… FunciÃ³n generate_content_hash(): Operativa
â”œâ”€â”€ âœ… Sistema de verificaciÃ³n: Programado para 2025-12-26
â”œâ”€â”€ âœ… Alertas automÃ¡ticas: Configuradas por prioridad
â””â”€â”€ âœ… Trazabilidad completa: Historial de cambios disponible

ğŸ” FUNCIONES DE CONTROL:
â”œâ”€â”€ generate_content_hash(text) â†’ SHA-256 hash
â”œâ”€â”€ check_law_update_needed(law_id) â†’ Boolean + detalles
â”œâ”€â”€ get_laws_needing_verification() â†’ Lista priorizada
â””â”€â”€ law_update_status â†’ Vista resumen ejecutivo
```

### âœ… **Arquitectura HÃ­brida Funcionando:** â­ *REVOLUCIONARIO*
```
ğŸš€ CONSULTAS ULTRARRÃPIDAS:
â”œâ”€â”€ get_article_context_final('103', 'Auxiliar') 
â”œâ”€â”€ â†’ FREQUENT, 3 apariciones, [2021,2022,2023], "ğŸ“š Repasar bien"
â”œâ”€â”€ Performance: <1ms (vs. 50ms con JOINs complejos)
â””â”€â”€ Zero duplicados garantizado

ğŸ“Š DATOS CONSOLIDADOS:
â”œâ”€â”€ article_exam_stats: 4 registros Ãºnicos sin duplicados
â”œâ”€â”€ Constraint UNIQUE(article_id, oposicion_id)
â”œâ”€â”€ MigraciÃ³n automÃ¡tica desde articulos_examenes
â””â”€â”€ ActualizaciÃ³n automÃ¡tica con triggers
```

### âœ… **Funciones SQL Operativas (25+ funciones):**
```
ğŸ“Š GENERACIÃ“N DE TESTS:
â”œâ”€â”€ get_topic_questions_v2() âœ…
â”œâ”€â”€ generate_test_by_topic() âœ…  
â”œâ”€â”€ get_article_questions() âœ…

ğŸ¯ EXÃMENES OFICIALES â­ IMPLEMENTADO:
â”œâ”€â”€ get_examen_oficial_exacto() âœ…
â”œâ”€â”€ get_preguntas_oficiales_por_tema() âœ…
â”œâ”€â”€ get_estadisticas_examenes_oficiales() âœ…
â”œâ”€â”€ get_articles_missing_questions() âœ…

ğŸ§  CONTEXTO INTELIGENTE â­ IMPLEMENTADO:
â”œâ”€â”€ get_question_exam_context_v2() âœ…
â”œâ”€â”€ get_article_context_final() âœ… NUEVA - HÃBRIDA
â”œâ”€â”€ get_oposicion_articles() âœ…
â”œâ”€â”€ get_oposicion_coverage_stats() âœ…

ğŸ”’ CONTROL DE VERSIONES â­ NUEVO:
â”œâ”€â”€ generate_content_hash() âœ…
â”œâ”€â”€ check_law_update_needed() âœ…
â”œâ”€â”€ get_laws_needing_verification() âœ…
â”œâ”€â”€ migrate_existing_exam_data() âœ…

âœ¨ SISTEMA IA ADAPTATIVO â­ NUEVO:
â”œâ”€â”€ calculate_personal_difficulty() âœ…
â”œâ”€â”€ calculate_trend() âœ…
â”œâ”€â”€ update_user_question_history() âœ…
â”œâ”€â”€ migrate_existing_data() âœ…
â”œâ”€â”€ recalculate_user_metrics() âœ…
â””â”€â”€ get_personalized_insights() âœ…

ğŸ“ˆ ANÃLISIS AVANZADO:
â”œâ”€â”€ get_question_stats_by_position() âœ…
â”œâ”€â”€ get_official_exam_coverage_stats() âœ…
â”œâ”€â”€ get_user_progress_analytics() â³
â”œâ”€â”€ get_recommendation_engine() â³
â””â”€â”€ generate_official_exam_simulation() âœ…
```

---


### Seguridad
- Row Level Security en Supabase
- EncriptaciÃ³n de datos sensibles
- AuditorÃ­a de accesos
- **ğŸ†• Integridad de datos** con hashes SHA-256
- **ğŸ†• Control de versiones** para trazabilidad

---

## ğŸ“ˆ Escalabilidad Futura

### Nuevas Oposiciones
- FÃ¡cil adiciÃ³n de nuevos temarios
- Plantillas reutilizables
- Sistema multi-tenant
- **ğŸ†• Mapeo automÃ¡tico** de artÃ­culos entre oposiciones similares
- **ğŸ†• ReutilizaciÃ³n inteligente** de exÃ¡menes oficiales
- **ğŸ†• MigraciÃ³n automÃ¡tica** con arquitectura hÃ­brida

### Features Premium
- Tests ilimitados
- Analytics avanzados
- Simulacros oficiales
- TutorÃ­as personalizadas
- **ğŸ†• Acceso prioritario** a exÃ¡menes oficiales exactos
- **ğŸ†• Predicciones de exÃ¡menes** basadas en IA
- **ğŸ†• Alertas de artÃ­culos** muy preguntados
- **ğŸ†• Dashboard de integridad** de contenido


---

## ğŸš€ Beneficios Revolucionarios

### Para Estudiantes: Asistente Personal de Aprendizaje
- **ğŸ§  Inteligencia Adaptativa**: Tu asistente personal que aprende de cada respuesta
- **âœ¨ AdaptaciÃ³n Visual en Tiempo Real**: Indicador "AdaptÃ¡ndose a tu nivel" cuando el rendimiento baja del 60%
- **ğŸ“Š Insights AutomÃ¡ticos**: "Tu precisiÃ³n en Tema 5 mejorÃ³ 17% esta semana"
- **ğŸ¯ DetecciÃ³n Temprana**: Alertas antes de que tu rendimiento baje
- **âš¡ Acciones Inmediatas**: Tests dirigidos en 5 minutos para problemas especÃ­ficos
- **ğŸ“ˆ MotivaciÃ³n Inteligente**: Celebra logros reales con datos concretos
- **ğŸª AdaptaciÃ³n de Patrones**: Detecta tu horario Ã³ptimo de estudio automÃ¡ticamente
- **Estudio personalizado** basado en debilidades reales
- **Progreso visual** y motivador por artÃ­culo especÃ­fico
- **Flexibilidad total** en configuraciÃ³n de tests
- **Acceso desde cualquier dispositivo**
- **Preguntas consistentes** entre diferentes oposiciones
- **ğŸ†• Enfoque estratÃ©gico** en artÃ­culos que "caen seguro" en exÃ¡menes
- **ğŸ†• Experiencia real** con exÃ¡menes oficiales exactos
- **ğŸ†• Confianza mÃ¡xima** al conocer el historial de cada artÃ­culo
- **ğŸ‰ Base constitucional completa** - Los 169 artÃ­culos disponibles
- **ğŸ†• Contenido siempre actualizado** - VerificaciÃ³n automÃ¡tica
- **ğŸ†• Performance optimizada** - Consultas ultrarrÃ¡pidas

### Para Administradores: Ventaja Competitiva Sostenible
- **ğŸ§  Sistema de IA Ãšnico**: Impossible de replicar por competencia tradicional
- **ğŸ“Š Analytics Predictivos**: Datos sobre quÃ© contenido funciona mejor
- **ğŸ¯ RetenciÃ³n Mejorada**: Usuarios enganchados por insights personalizados
- **âš¡ MonetizaciÃ³n Premium**: Features de IA como valor diferenciado
- **ğŸ”„ Escalabilidad IA**: El sistema mejora automÃ¡ticamente con mÃ¡s usuarios
- **GestiÃ³n centralizada** de contenido por artÃ­culo
- **ReutilizaciÃ³n automÃ¡tica** de preguntas entre oposiciones
- **Datos valiosos** sobre efectividad del material legal especÃ­fico
- **Escalabilidad** para mÃºltiples oposiciones sin duplicaciÃ³n
- **Base sÃ³lida** para monetizaciÃ³n futura
- **ğŸ†• Analytics histÃ³ricos** de exÃ¡menes oficiales para crear contenido estratÃ©gico
- **ğŸ†• Ventaja competitiva Ãºnica** con datos exclusivos de exÃ¡menes
- **ğŸ†• ROI medible** en contenido basado en frecuencia histÃ³rica
- **ğŸ‰ DiferenciaciÃ³n total** - Base constitucional mÃ¡s completa del mercado
- **ğŸ†• Control de calidad** - Integridad automÃ¡tica de datos
- **ğŸ†• Mantenimiento automatizado** - Sistema de versiones

## ğŸ† **Posicionamiento EstratÃ©gico: Dominio del Mercado**

### ğŸ¥‡ **Ventaja Competitiva Insuperable**

**iLoveTest no compite en el mercado de "webs de tests" - creamos una nueva categorÃ­a:**

#### ğŸ§  **"Asistente Personal de Aprendizaje Legal con IA"**

**Competencia tradicional:**
- âŒ Tests estÃ¡ticos sin personalizaciÃ³n
- âŒ Feedback genÃ©rico o inexistente  
- âŒ Sin detecciÃ³n de patrones de aprendizaje
- âŒ Sin predicciÃ³n de problemas
- âŒ Sin motivaciÃ³n adaptativa

**iLoveTest (Nueva categorÃ­a):**
- âœ… **IA que aprende** de cada respuesta del usuario
- âœ… **PredicciÃ³n automÃ¡tica** de Ã¡reas problemÃ¡ticas
- âœ… **Insights personalizados** basados en comportamiento real
- âœ… **Acciones directas** para cada problema detectado
- âœ… **MotivaciÃ³n inteligente** solo cuando aporta valor
- âœ… **Patrones de estudio** detectados automÃ¡ticamente

### ğŸ“Š **Barreras de Entrada para Competencia**

#### ğŸ”’ **Imposible de Replicar FÃ¡cilmente:**

1. **ğŸ§  Arquitectura de IA Compleja** (6 tipos de anÃ¡lisis integrados)
2. **ğŸ“Š Algoritmos de DetecciÃ³n** (mejoras, regresiones, patrones)
3. **âš¡ Motor de AnÃ¡lisis Tiempo Real** (datos histÃ³ricos + predicciÃ³n)
4. **ğŸ¯ Sistema de Acciones Contextuales** (URLs especÃ­ficas por problema)
5. **ğŸ’¾ Persistencia Inteligente** (localStorage + BD + frecuencia)
6. **ğŸ”„ Bucle de Mejora Continua** (cada usuario mejora el sistema)

#### ğŸ’° **MonetizaciÃ³n Premium Sostenible:**

- **Tier BÃ¡sico**: Tests tradicionales (como la competencia)
- **Tier Premium**: **Asistente Personal de IA** (Ãºnico en el mercado)
  - AnÃ¡lisis predictivo personalizado
  - DetecciÃ³n automÃ¡tica de problemas
  - Rutas de estudio adaptativas
  - Insights de rendimiento en tiempo real

### ğŸ¯ **Estrategia de Dominio**

1. **Fase 1 âœ…**: Consolidar base tÃ©cnica (21 tablas + 19 funciones + IA)
2. **Fase 2 ğŸ”„**: Lanzar MVP con IA bÃ¡sica funcionando
3. **Fase 3 ğŸ“ˆ**: Expandir con IA avanzada (ML, predicciones)
4. **Fase 4 ğŸ†**: Dominar mercado como lÃ­der indiscutible

> **ğŸ¯ OBJETIVO**: Que cuando alguien busque "preparaciÃ³n oposiciones online", piense inmediatamente en **iLoveTest** como el estÃ¡ndar de oro con IA personal.





### **Innovaciones TÃ©cnicas Revolucionarias:**
- **ğŸ†• Sistema de hashes SHA-256** para detectar cambios automÃ¡ticamente
- **ğŸ†• VerificaciÃ³n programada** de actualizaciones BOE
- **ğŸ†• Arquitectura hÃ­brida** que combina velocidad + anÃ¡lisis profundo
- **ğŸ†• Constraints Ãºnicos** que previenen duplicados para siempre

### **Potencial de MonetizaciÃ³n:**
- **Base sÃ³lida** para features premium
- **Ventaja competitiva** sostenible a largo plazo
- **Escalabilidad** a mÃºltiples oposiciones sin esfuerzo adicional
- **ROI medible** basado en datos histÃ³ricos reales
- **ğŸ†• DiferenciaciÃ³n tÃ©cnica** imposible de replicar fÃ¡cilmente
- **ğŸ†• Valor agregado** con integridad automÃ¡tica de contenido

### **Posicionamiento EstratÃ©gico:**
**Tu sistema iLoveTest estÃ¡ posicionado para dominar el mercado de oposiciones online con una ventaja competitiva tÃ©cnica y de contenido que serÃ¡ muy difÃ­cil de igualar por la competencia.** 

La combinaciÃ³n de:
- **TecnologÃ­a mÃ¡s avanzada** (21 tablas + 19 funciones + control de versiones)
- **Arquitectura mÃ¡s escalable** (hÃ­brida + sin duplicados + reutilizaciÃ³n)


